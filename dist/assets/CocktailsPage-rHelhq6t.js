import{d as h,r as m,w as I,h as $,i as E,c as u,o as l,j as C,n as L,k as R,l as i,t as _,F as g,m as f,a as v,p as b,u as p,q as T,s as A,v as M,x as S}from"./vendor-C4M16nVi.js";import{_ as y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{C as O}from"./index-CehdTWD-.js";const B=["src","alt"],D={key:1,class:"spinner"},V=h({__name:"LazyImage",props:{src:{},alt:{}},setup(e){const o=e,t=m(!1),a=m(!1),c=m(null);let s=null;const n=()=>{a.value=!0},r=()=>{"IntersectionObserver"in window?(s=new IntersectionObserver(([d])=>{d.isIntersecting&&(t.value=!0,s?.disconnect())},{rootMargin:"0px",threshold:.1}),c.value&&s.observe(c.value)):t.value=!0};return I(()=>o.src,()=>{r()}),$(()=>{r()}),E(()=>{s?.disconnect()}),(d,k)=>(l(),u("div",{ref_key:"container",ref:c,class:"image-container"},[t.value?(l(),u("img",{key:0,src:d.src,alt:d.alt,class:L({loaded:a.value}),onLoad:n},null,42,B)):C("",!0),a.value?C("",!0):(l(),u("div",D))],512))}}),N=y(V,[["__scopeId","data-v-3944b4fe"]]),j={class:"cocktail"},x={class:"cocktail__info"},z={class:"cocktail__title"},K={class:"cocktail__tags"},P={class:"cocktail__instructions"},U={class:"cocktail__ingredients-table"},F={class:"cocktail__image"},G=h({__name:"CocktailItem",props:{cocktailItem:{}},setup(e){const o=e,t=R(()=>[{key:"category",value:o.cocktailItem.category},{key:"alcoholic",value:o.cocktailItem.alcoholic},{key:"glass",value:o.cocktailItem.glass}].filter(c=>c.value));return(a,c)=>(l(),u("div",j,[i("div",x,[i("h2",z,_(a.cocktailItem.name),1),i("ul",K,[(l(!0),u(g,null,f(t.value,s=>(l(),u("li",{key:s.key,class:"cocktail__tag"},_(s.value),1))),128))]),c[1]||(c[1]=i("h3",{class:"cocktail__subtitle"}," Instruction: ",-1)),i("p",P,_(a.cocktailItem.instructions),1),c[2]||(c[2]=i("h2",{class:"cocktail__subtitle"}," List of ingredients: ",-1)),i("table",U,[c[0]||(c[0]=i("thead",null,[i("tr",null,[i("th",null,"Ingredient"),i("th",null,"Measure")])],-1)),i("tbody",null,[(l(!0),u(g,null,f(a.cocktailItem.ingredients,s=>(l(),u("tr",{key:`${s.name}-${s.measure}`,class:"cocktail__ingredient-row"},[i("td",null,_(s.name),1),i("td",null,_(s.measure||"-"),1)]))),128))])])]),i("div",F,[v(N,{src:a.cocktailItem.image||"",alt:a.cocktailItem.name},null,8,["src","alt"])])]))}}),q=y(G,[["__scopeId","data-v-e087b627"]]);class J{async get(o,t={}){const{headers:a={},timeoutMs:c=7e3}=t,s=new AbortController,n=setTimeout(()=>s.abort(),c);let r;try{r=await fetch(o,{method:"GET",headers:a,signal:s.signal})}catch(d){throw clearTimeout(n),d&&typeof d=="object"&&"name"in d&&d.name==="AbortError"?new Error("TIMEOUT"):d}if(clearTimeout(n),r.status===500)throw new Error("SERVER_ERROR");if(!r.ok)throw new Error(`API Error: ${r.status}`);return r.json()}}const W=new J,H=b("cache",()=>{const e=m({}),o=5*60*1e3,t=(n,r)=>{const d=r?JSON.stringify(r):"";return`${n}${d}`},a=n=>Date.now()-n.timestamp>n.ttl;return{cache:e,get:(n,r)=>{const d=t(n,r),k=e.value[d];return k?a(k)?(delete e.value[d],null):k.data:null},set:(n,r,d=o,k)=>{const w=t(n,k);e.value[w]={data:r,timestamp:Date.now(),ttl:d}}}}),Q=e=>{const o=[];return Object.keys(e).forEach(t=>{if(t.startsWith("strIngredient")){const a=e[t];if(a&&a.trim()){const s=`strMeasure${t.replace("strIngredient","")}`,n=e[s];o.push({name:a.trim(),measure:n&&n.trim()?n.trim():null})}}}),o},X=e=>{const o=Q(e);return{id:e.idDrink,name:e.strDrink,alternateName:e.strDrinkAlternate,category:e.strCategory,alcoholic:e.strAlcoholic,glass:e.strGlass,instructions:e.strInstructions,image:e.strDrinkThumb,dateModified:e.dateModified,ingredients:o}},Y=e=>e.map(X),Z={async getCocktailsByCode(e){const o=H(),t=`https://www.thecocktaildb.com/api/json/v1/1/search.php?s=${e}`,a=o.get(t);if(a)return a;const s=(await W.get(t)).drinks||[],n=Y(s);return o.set(t,n),n}},ee=b("cocktail",()=>{const e=m([]),o=m(!1),t=m(null);return{cocktails:e,isLoading:o,error:t,fetchCocktailsByCode:async c=>{if(!c.trim()){t.value="Поисковый запрос не может быть пустым";return}o.value=!0,t.value=null;try{const s=await Z.getCocktailsByCode(c);s&&s.length>0?e.value=s:e.value=[]}catch(s){s instanceof Error?s.message==="TIMEOUT"?t.value="Время ожидания истекло. Попробуйте позже.":s.message==="SERVER_ERROR"?t.value="Ошибка сервера. Попробуйте позже.":t.value=s.message:t.value="Произошла ошибка при загрузке коктейлей",e.value=[]}finally{o.value=!1}}}}),te={class:"cocktail-list"},se={key:0,class:"cocktail-list__loading"},oe={key:1,class:"cocktail-list__error"},ae={key:2,class:"cocktail-list__empty"},ce={key:3,class:"cocktail-list__content"},ne=h({__name:"CocktailList",props:{cocktailCode:{}},setup(e){const o=e,t=ee(),a=async s=>{await t.fetchCocktailsByCode(s)};I(()=>o.cocktailCode,s=>{s&&a(s)},{immediate:!0});const c=m("Пока ничего нет");return(s,n)=>(l(),u("div",te,[p(t).isLoading?(l(),u("div",se," Загрузка коктейлей... ")):p(t).error?(l(),u("div",oe,_(p(t).error),1)):p(t).cocktails.length===0?(l(),u("div",ae,_(c.value),1)):(l(),u("div",ce,[(l(!0),u(g,null,f(p(t).cocktails,r=>(l(),T(q,{key:r.id,"cocktail-item":r},null,8,["cocktail-item"]))),128))]))]))}}),re=y(ne,[["__scopeId","data-v-999421a4"]]),ie={class:"sidebar-menu"},le={class:"sidebar-menu__list"},ue=h({__name:"SidebarMenu",props:{cocktailCodes:{}},setup(e){return(o,t)=>{const a=A("RouterLink");return l(),u("div",ie,[i("ul",le,[(l(!0),u(g,null,f(o.cocktailCodes,c=>(l(),u("li",{key:c,class:"sidebar-menu__item"},[v(a,{to:`/${c}`,class:"sidebar-menu__link"},{default:M(()=>[S(_(c),1)]),_:2},1032,["to"])]))),128))])])}}}),de={class:"cocktail-page"},_e={class:"container"},me={class:"cocktail-page__content"},ke=h({__name:"CocktailsPage",props:{cocktailCode:{}},setup(e){return(o,t)=>(l(),u("div",de,[t[0]||(t[0]=i("h1",{class:"cocktail-page__title"}," Cocktails ",-1)),i("div",_e,[i("div",me,[v(ue,{"cocktail-codes":p(O)},null,8,["cocktail-codes"]),v(re,{"cocktail-code":o.cocktailCode},null,8,["cocktail-code"])])])]))}}),fe=y(ke,[["__scopeId","data-v-ba6e0f47"]]);export{fe as default};
